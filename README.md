# Infrastructure
Setup bootstrap for Windows applications [archival]

This is an old project of mine, that I created back in 2007.<br/>
Imported into GitHub for archival puposes only.<br/>
There will be no updates.

## Screenshot
<img alt='Screenshot for Infrastructure Setup' src='http://pjondevelopment.50webs.com/images/articles/12.jpg' width='390' height='271' />

<H2>Introduction</H2><P>This code is an old project of mine that was originally published at <A href="http://planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=3221&amp;lngWId=10">Planet Source Code</A>, which in turn was an evolution of a even previous project from Kevin Moore (you can find Kevin's original project <A href="http://www.codeproject.com/managedcpp/dotnetsetup.asp">here</A>). </P><P>This version has several enhancements, though.</P><P>I've enhanced the verification of the IE (which is configurable now), the MDAC, and the .NET platform versions, as well making possible to pass customized parameter to each one of the installers. </P><H2>Compiling the code</H2><P>To compile the code you only need the Visual Studio 2005. It was compiled using the default settings for the Visual C++.</P><P>Just remember to&nbsp;change your build settings to <FONT face="Courier New">Release</FONT>, otherwise it will only display the commands it would execute when the user click on the Install button.</P><H2>Customizing</H2><P>To customize this setup bootstrap you&nbsp;just need to modify the file <FONT face="Courier New">settings.ini</FONT>. Each and every key is described below.</P><H3>The settings.ini file</H3><P>There are two sections in the INI file:</P><UL><LI><CODE>[Bootstrap]</CODE><BR />Gathers the information about the location&nbsp;of the installers for the infrastructure components, and;<BR /></LI><LI><CODE>[WhatInstall]</CODE><BR />Configures what is necessary to the current installation.</LI></UL><H4>The Bootstrap section</H4><P>This section may contain the following keys:</P><TABLE cellSpacing="0" cellPadding="2" border="1"><TBODY><TR><TD><STRONG>Key</STRONG> </TD><TD><STRONG>Status</STRONG> </TD><TD><STRONG>Description</STRONG></TD></TR><TR><TD vAlign="top"><CODE>CaptionText</CODE> </TD><TD vAlign="top">optional </TD><TD vAlign="top">The title of all the message box that will be displayed.<BR />defaults to <CODE>&quot;&lt;ProductName&gt; Setup&quot;</CODE></TD></TR><TR><TD vAlign="top"><CODE>ErrorCaptionText</CODE> </TD><TD vAlign="top">optional </TD><TD vAlign="top">The title of all the <STRONG>error</STRONG> message box that will be displayed.<BR />defaults to <CODE>&quot;&lt;ProductName&gt; Setup Error&quot;</CODE> </TD></TR><TR><TD vAlign="top"><CODE>FxInstallerName</CODE> </TD><TD vAlign="top">optional </TD><TD vAlign="top">Name of the redistributable .NET setup<BR />defaults to <CODE>&quot;dotnetfx.exe&quot;</CODE> </TD></TR><TR><TD vAlign="top"><CODE>FxInstallerPath</CODE> </TD><TD vAlign="top">optional </TD><TD vAlign="top">Relative path to &quot;DOTNETFX.EXE&quot;<BR />defaults to the <CODE>SETUP.EXE</CODE> path. </TD></TR><TR><TD vAlign="top"><CODE>FxInstallerParams</CODE> </TD><TD vAlign="top">optional </TD><TD vAlign="top">Command line parameter to passed to the .NET installer.<BR />defaults to <CODE>/q:a /c:&quot;install /l /q&quot;</CODE> </TD></TR><TR><TD vAlign="top"><CODE>FxVersion</CODE> </TD><TD vAlign="top">mandatory<SUP>1</SUP> </TD><TD vAlign="top">Version of the .NET Framework required by the application.<BR />Requires the FULL version. <UL><LI><CODE>v1.0.3705</CODE> </LI><LI><CODE>v1.1.4322</CODE> </LI><LI><CODE>v2.0.50727</CODE> </LI><LI><CODE>v3.0</CODE></LI></UL></TD></TR><TR><TD vAlign="top"><CODE>IEInstallerName</CODE> </TD><TD vAlign="top">optional </TD><TD vAlign="top">The name of the IE installer<BR />defaults to <CODE>&quot;ie6setup.exe&quot;</CODE> </TD></TR><TR><TD vAlign="top"><CODE>IEInstallerPath</CODE> </TD><TD vAlign="top">optional </TD><TD vAlign="top">Relative path to the IE installer.<BR />defaults to the <CODE>SETUP.EXE</CODE> path. </TD></TR><TR><TD vAlign="top"><CODE>IEInstallerParams</CODE> </TD><TD vAlign="top">optional </TD><TD vAlign="top">Command line parameters passed to the IE installer.<BR />defaults to <CODE>/passive</CODE> </TD></TR><TR><TD vAlign="top"><CODE>IEVersion</CODE> </TD><TD vAlign="top">mandatory<SUP>1</SUP> </TD><TD vAlign="top">The minimal version of the IE required by the application.<BR />defaults to <CODE>6.0</CODE> </TD></TR><TR><TD vAlign="top"><CODE>MDACInstallerPath</CODE> </TD><TD vAlign="top">optional </TD><TD vAlign="top">Relative path to the MDAC installer.<BR />defaults to the <CODE>SETUP.EXE</CODE> path. </TD></TR><TR><TD vAlign="top"><CODE>MDACInstallerParams</CODE> </TD><TD vAlign="top">optional </TD><TD vAlign="top">Command line parameters passed to the MDAC installer.<BR />defaults to <CODE>/q</CODE> </TD></TR><TR><TD vAlign="top"><CODE>MDACVersion</CODE> </TD><TD vAlign="top">mandatory<SUP>1</SUP> </TD><TD vAlign="top">The minimal version of the MDAC required by the application.<BR />defaults to <CODE>2.7</CODE> </TD></TR><TR><TD vAlign="top"><CODE>MSDEInstallerPath</CODE> </TD><TD vAlign="top">optional </TD><TD vAlign="top">Relative path to the MSDE installer<BR />defaults to the <CODE>SETUP.EXE</CODE> path. </TD></TR><TR><TD vAlign="top"><CODE>MSDEInstallerParams</CODE><SUP>2</SUP> </TD><TD vAlign="top">optional </TD><TD vAlign="top">Command line parameters passed to the MSDE installer.<BR />defaults to <CODE>/setup.ini /SAPWD='password'</CODE> </TD></TR><TR><TD vAlign="top"><CODE>MSIInstallerName</CODE> </TD><TD vAlign="top">optional </TD><TD vAlign="top">The name of the Windows Installer installer.<BR />defaults to <UL><LI><CODE>INSTMSIA.EXE</CODE> for Win9x </LI><LI><CODE>INSTMSIW.EXE</CODE> for Win2000 </LI><LI><CODE>INSTMSI.EXE</CODE><SUP>3</SUP> for WinXP and up</LI></UL></TD></TR><TR><TD vAlign="top"><CODE>MSIInstallerPath</CODE> </TD><TD vAlign="top">optional </TD><TD vAlign="top">Relative path to the Windows Installer installer.<BR />defaults to the <CODE>SETUP.EXE</CODE> path. </TD></TR><TR><TD vAlign="top"><CODE>MSIInstallerParams</CODE> </TD><TD vAlign="top">optional </TD><TD vAlign="top">Command line parameter passed to the Windows Installer installer<BR />defaults to <CODE>/Q</CODE> </TD></TR><TR><TD vAlign="top"><CODE>Package</CODE> </TD><TD vAlign="top">mandatory </TD><TD vAlign="top">The MSI package to be installed, i.e. YOUR application installer. </TD></TR><TR><TD vAlign="top"><CODE>ProductName</CODE> </TD><TD vAlign="top">optional </TD><TD vAlign="top">The name of your product.<BR />defaults to <CODE>&quot;Application&quot;</CODE></TD></TR></TBODY></TABLE><BR /><TABLE cellSpacing="0" cellPadding="1" border="0"><TBODY><TR><TD vAlign="top"><SUP>1</SUP> </TD><TD vAlign="top">The keys marked mandatory<SUP>1</SUP> are mandatory only if the specified component is required by the application. See [WhatInstall] section below.<BR /></TD></TR><TR><TD vAlign="top"><SUP>2</SUP> </TD><TD vAlign="top">In the <CODE>MSDEParams</CODE> key you may specify the SA password in the command line, however, it will be stored as plain text in the <CODE>&quot;settings.ini&quot;</CODE>. This might raise some security issues within your application. <BR /><STRONG>Be aware of this</STRONG>.<BR /></TD></TR><TR><TD vAlign="top"><SUP>3</SUP> </TD><TD vAlign="top">The Windows Installer installers version 3.0 and 3.1 have non-standard names, you may use any name you want just setting this key, however it defaults to <CODE>INSTMSI.EXE</CODE> for Windows XP and up in order to provide a minimal standardization.</TD></TR></TBODY></TABLE><H4>The WhatInstall section</H4><P>This section may contain the following keys:</P><TABLE cellSpacing="0" cellPadding="2" border="1"><TBODY><TR><TD><STRONG>Key</STRONG> </TD><TD><STRONG>Value</STRONG> </TD><TD><STRONG>Description</STRONG> </TD></TR><TR><TD><CODE>.NETFramework</CODE> </TD><TD><CODE>1</CODE> or <CODE>0</CODE> </TD><TD>.NET Framework </TD></TR><TR><TD><CODE>IE</CODE> </TD><TD><CODE>1</CODE> or <CODE>0</CODE> </TD><TD>Internet Explorer </TD></TR><TR><TD><CODE>MDAC</CODE> </TD><TD><CODE>1</CODE> or <CODE>0</CODE> </TD><TD>Microsoft Data Access Component </TD></TR><TR><TD><CODE>MSDE</CODE> </TD><TD><CODE>1</CODE> or <CODE>0</CODE> </TD><TD>Microsoft SQL Server Desktop Engine </TD></TR><TR><TD><CODE>WindowsInstaller</CODE> </TD><TD><CODE>1</CODE> or <CODE>0</CODE> </TD><TD>A new version of the Windows Installer </TD></TR></TBODY></TABLE><P>This section specifies which component&nbsp;is&nbsp;required by the application.</P>
